<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1725px" preserveAspectRatio="none" style="width:970px;height:1725px;" version="1.1" viewBox="0 0 970 1725" width="970px" zoomAndPan="magnify"><defs><filter height="300%" id="f9npktkeyjjaz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="211" x="380.5" y="26.708">dSignIn - 3 step process</text><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="98.5313" style="stroke: #383838; stroke-width: 1.0;" width="10" x="687" y="567.7734"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="216.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="687" y="795.1016"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="216.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="762" y="1189.9609"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="1261.9766" style="stroke: #383838; stroke-width: 1.0;" width="10" x="837" y="397.9766"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="279.5938" style="stroke: #000000; stroke-width: 2.0;" width="876" x="83" y="90.25"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="155.6641" style="stroke: #000000; stroke-width: 2.0;" width="567" x="189" y="864.3672"/><rect fill="#FFFFFF" height="70.2656" style="stroke: none; stroke-width: 1.0;" width="567" x="189" y="949.7656"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="155.6641" style="stroke: #000000; stroke-width: 2.0;" width="642" x="189" y="1259.2266"/><rect fill="#FFFFFF" height="70.2656" style="stroke: none; stroke-width: 1.0;" width="642" x="189" y="1344.625"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="155.6641" style="stroke: #000000; stroke-width: 2.0;" width="717" x="189" y="1512.2891"/><rect fill="#FFFFFF" height="70.2656" style="stroke: none; stroke-width: 1.0;" width="717" x="189" y="1597.6875"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="244" x2="244" y1="73.25" y2="1684.9531"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="692" x2="692" y1="73.25" y2="1684.9531"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="767" x2="767" y1="73.25" y2="1684.9531"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="842" x2="842" y1="73.25" y2="1684.9531"/><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="86" x="199" y="37.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="206" y="57.9482">Consumer</text><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="86" x="199" y="1683.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="206" y="1703.9482">Consumer</text><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="658" y="37.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="665" y="57.9482">mORKx</text><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="658" y="1683.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="665" y="1703.9482">mORKx</text><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="58" x="736" y="37.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="743" y="57.9482">vORKx</text><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="58" x="736" y="1683.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="743" y="1703.9482">vORKx</text><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="808" y="37.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="815" y="57.9482">Vendor</text><rect fill="#F8F8F8" filter="url(#f9npktkeyjjaz)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="808" y="1683.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="815" y="1703.9482">Vendor</text><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="98.5313" style="stroke: #383838; stroke-width: 1.0;" width="10" x="687" y="567.7734"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="216.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="687" y="795.1016"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="216.9297" style="stroke: #383838; stroke-width: 1.0;" width="10" x="762" y="1189.9609"/><rect fill="#FFFFFF" filter="url(#f9npktkeyjjaz)" height="1261.9766" style="stroke: #383838; stroke-width: 1.0;" width="10" x="837" y="397.9766"/><path d="M83,90.25 L153,90.25 L153,97.25 L143,107.25 L83,107.25 L83,90.25 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="279.5938" style="stroke: #000000; stroke-width: 2.0;" width="876" x="83" y="90.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="98" y="103.3169">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="168" y="102.4604">[Precondition]</text><path d="M93,112.3828 L93,152.3828 L391,152.3828 L391,122.3828 L381,112.3828 L93,112.3828 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M381,112.3828 L381,122.3828 L391,122.3828 L381,112.3828 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="99" y="129.4497">username = Consumer username</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="99" y="144.5825">password [private] = Consumer's password</text><path d="M528,166.6484 L528,236.6484 L852,236.6484 L852,176.6484 L842,166.6484 L528,166.6484 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M842,166.6484 L842,176.6484 L852,176.6484 L842,166.6484 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="534" y="183.7153">userId = hash(username)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="534" y="198.8481">AuthPRISMi = share(AuthPRISM, orkId) [private]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="534" y="213.981">CMKAuthi = hmac(pkORKi, AuthProof) [private]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="534" y="229.1138">CMKi = share(skCMK, orkId) [private]</text><path d="M589,251.1797 L589,306.1797 L941,306.1797 L941,261.1797 L931,251.1797 L589,251.1797 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M931,251.1797 L931,261.1797 L941,261.1797 L931,251.1797 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="595" y="268.2466">VUID = hash(pkVen * skCMK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="331" x="595" y="283.3794">CVKAuthi = hmac(pkORKi, pkVen * skCMK) [private]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="595" y="298.5122">CVKi = share(skCVK, orkId) [private]</text><path d="M735,320.5781 L735,360.5781 L945,360.5781 L945,330.5781 L935,320.5781 L735,320.5781 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M935,320.5781 L935,330.5781 L945,330.5781 L935,320.5781 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="741" y="337.645">VUID = hash(pkVen * skCMK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="741" y="352.7778">pkCVK</text><polygon fill="#383838" points="825,393.9766,835,397.9766,825,401.9766,829,397.9766" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="244" x2="831" y1="397.9766" y2="397.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="251" y="392.9106">GetChallenge()</text><polygon fill="#383838" points="255,423.1094,245,427.1094,255,431.1094,251,427.1094" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="836" y1="427.1094" y2="427.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="261" y="422.0435">pkVen, challenge</text><path d="M102,440.1094 L102,495.1094 L381,495.1094 L381,450.1094 L371,440.1094 L102,440.1094 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M371,440.1094 L371,450.1094 L381,450.1094 L371,440.1094 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="108" y="457.1763">r1 = random [private]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="108" y="472.3091">userId = hash(username)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="108" y="487.4419">gPass = point(hash(password)) [private]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="244" x2="286" y1="525.6406" y2="525.6406"/><line style="stroke: #383838; stroke-width: 1.0;" x1="286" x2="286" y1="525.6406" y2="538.6406"/><line style="stroke: #383838; stroke-width: 1.0;" x1="245" x2="286" y1="538.6406" y2="538.6406"/><polygon fill="#383838" points="255,534.6406,245,538.6406,255,542.6406,251,538.6406" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="251" y="520.5747">Resolve mORKs by userId</text><polygon fill="#383838" points="675,563.7734,685,567.7734,675,571.7734,679,567.7734" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="244" x2="681" y1="567.7734" y2="567.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="251" y="562.7075">Convert( userId , gPass * r1 )</text><path d="M561,580.7734 L561,635.7734 L819,635.7734 L819,590.7734 L809,580.7734 L561,580.7734 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M809,580.7734 L809,590.7734 L819,590.7734 L809,580.7734 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="567" y="597.8403">(gPass * r1) ∈ G</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="567" y="612.9731">timestamp = now()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="567" y="628.106">certtime = hmac(timestamp, skORK)</text><polygon fill="#383838" points="255,662.3047,245,666.3047,255,670.3047,251,666.3047" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="691" y1="666.3047" y2="666.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="293" x="261" y="661.2388">gPass * r1 * AuthPRISMi, timestamp, certtime</text><path d="M8,679.3047 L8,764.3047 L477,764.3047 L477,689.3047 L467,679.3047 L8,679.3047 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M467,679.3047 L467,689.3047 L477,689.3047 L467,679.3047 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="14" y="696.3716">r2 = random [private]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="383" x="14" y="711.5044">gPass * AuthPRISM = ∑(gPass * r1 * AuthPRISMi) * (r1 ^ -1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="14" y="726.6372">authProof = hash(gPass * AuthPRISM)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="14" y="741.77">authVRFYi = hmac(pkORKi, authProof)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="14" y="756.9028">VERIFYi = hmac(userId | pkVen * r2 | timestamp | certtime, authVRFYi)</text><polygon fill="#383838" points="675,791.1016,685,795.1016,675,799.1016,679,795.1016" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="244" x2="681" y1="795.1016" y2="795.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="424" x="251" y="790.0356">Authenticate( userId , pkVen * r2 , timestamp , certtime , VERIFYi )</text><path d="M442,808.1016 L442,848.1016 L937,848.1016 L937,818.1016 L927,808.1016 L442,808.1016 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M927,808.1016 L927,818.1016 L937,818.1016 L927,808.1016 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="448" y="825.1685">(pkVen * r2) ∈ G ?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="474" x="448" y="840.3013">verifyCheck = hmac(userId | pkVen * r2 | timestamp | certtime, CMKAuthi)</text><path d="M189,864.3672 L253,864.3672 L253,871.3672 L243,881.3672 L189,881.3672 L189,864.3672 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="155.6641" style="stroke: #000000; stroke-width: 2.0;" width="567" x="189" y="864.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="204" y="877.4341">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="268" y="876.5776">[verifyCheck == VERIFYi ?]</text><path d="M639,886.5 L639,911.5 L741,911.5 L741,896.5 L731,886.5 L639,886.5 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M731,886.5 L731,896.5 L741,896.5 L731,886.5 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="645" y="903.5669">Log(AuthOK)</text><polygon fill="#383838" points="255,937.7656,245,941.7656,255,945.7656,251,941.7656" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="686" y1="941.7656" y2="941.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="261" y="936.6997">aesEnc(pkVen * r2 * CMKi, CMKAuthi)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="189" x2="756" y1="950.7656" y2="950.7656"/><path d="M637,956.7656 L637,981.7656 L742,981.7656 L742,966.7656 L732,956.7656 L637,956.7656 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M732,956.7656 L732,966.7656 L742,966.7656 L732,956.7656 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="643" y="973.8325">Log(AuthFail)</text><polygon fill="#383838" points="255,1008.0313,245,1012.0313,255,1016.0313,251,1012.0313" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="691" y1="1012.0313" y2="1012.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="261" y="1006.9653">Some consistent garbage</text><path d="M37,1032.0313 L37,1117.0313 L447,1117.0313 L447,1042.0313 L437,1032.0313 L37,1032.0313 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M437,1032.0313 L437,1042.0313 L447,1042.0313 L437,1032.0313 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="43" y="1049.0981">aesDec(pkVen * r2 * CMKi, authVRFYi)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="389" x="43" y="1064.231">cvkAuth = pkVen * skCMK = ∑(pkVen * r2 * CMKi) * (r2 ^ -1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="43" y="1079.3638">VUID = hash(cvkAuth)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="43" y="1094.4966">getVRFYi = hmac(pkORKi, cvkAuth)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="291" x="43" y="1109.6294">VERIFYi = hmac(VUID | timestamp , getVRFYi)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="244" x2="286" y1="1147.8281" y2="1147.8281"/><line style="stroke: #383838; stroke-width: 1.0;" x1="286" x2="286" y1="1147.8281" y2="1160.8281"/><line style="stroke: #383838; stroke-width: 1.0;" x1="245" x2="286" y1="1160.8281" y2="1160.8281"/><polygon fill="#383838" points="255,1156.8281,245,1160.8281,255,1164.8281,251,1160.8281" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="251" y="1142.7622">Resolve vORKs by VUID</text><polygon fill="#383838" points="750,1185.9609,760,1189.9609,750,1193.9609,754,1189.9609" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="244" x2="756" y1="1189.9609" y2="1189.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="251" y="1184.895">GetKey( VUID , timestamp , VERIFYi )</text><path d="M593,1202.9609 L593,1242.9609 L937,1242.9609 L937,1212.9609 L927,1202.9609 L593,1202.9609 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M927,1202.9609 L927,1212.9609 L937,1212.9609 L927,1202.9609 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="315" x="599" y="1220.0278">if timestamp is not current, reply with a challenge</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="599" y="1235.1606">verifyCheck = hmac(VUID | timestamp , CVKAuthi)</text><path d="M189,1259.2266 L253,1259.2266 L253,1266.2266 L243,1276.2266 L189,1276.2266 L189,1259.2266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="155.6641" style="stroke: #000000; stroke-width: 2.0;" width="642" x="189" y="1259.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="204" y="1272.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="268" y="1271.437">[verifyCheck == VERIFYi ?]</text><path d="M714,1281.3594 L714,1306.3594 L816,1306.3594 L816,1291.3594 L806,1281.3594 L714,1281.3594 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M806,1281.3594 L806,1291.3594 L816,1291.3594 L806,1281.3594 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="720" y="1298.4263">Log(AuthOK)</text><polygon fill="#383838" points="255,1332.625,245,1336.625,255,1340.625,251,1336.625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="761" y1="1336.625" y2="1336.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="261" y="1331.5591">aesEnc(CVKi, CVKAuthi)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="189" x2="831" y1="1345.625" y2="1345.625"/><path d="M712,1351.625 L712,1376.625 L817,1376.625 L817,1361.625 L807,1351.625 L712,1351.625 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M807,1351.625 L807,1361.625 L817,1361.625 L807,1351.625 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="718" y="1368.6919">Log(AuthFail)</text><polygon fill="#383838" points="255,1402.8906,245,1406.8906,255,1410.8906,251,1406.8906" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="766" y1="1406.8906" y2="1406.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="261" y="1401.8247">Some consistent garbage</text><path d="M98,1426.8906 L98,1466.8906 L386,1466.8906 L386,1436.8906 L376,1426.8906 L98,1426.8906 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M376,1426.8906 L376,1436.8906 L386,1436.8906 L376,1426.8906 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="104" y="1443.9575">CVK = ∑(aesDec(CMKi, getVRFYi))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="104" y="1459.0903">challengeRes = ECSign(challenge, skCVK)</text><polygon fill="#383838" points="825,1493.2891,835,1497.2891,825,1501.2891,829,1497.2891" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="244" x2="831" y1="1497.2891" y2="1497.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="251" y="1492.2231">SignIn( VUID , challengeRes )</text><path d="M189,1512.2891 L253,1512.2891 L253,1519.2891 L243,1529.2891 L189,1529.2891 L189,1512.2891 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="155.6641" style="stroke: #000000; stroke-width: 2.0;" width="717" x="189" y="1512.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="204" y="1525.356">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="221" x="268" y="1524.4995">[verifySig(challengeRes, pkCVK) ?]</text><path d="M789,1534.4219 L789,1559.4219 L891,1559.4219 L891,1544.4219 L881,1534.4219 L789,1534.4219 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M881,1534.4219 L881,1544.4219 L891,1544.4219 L881,1534.4219 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="795" y="1551.4888">Log(AuthOK)</text><polygon fill="#383838" points="255,1585.6875,245,1589.6875,255,1593.6875,251,1589.6875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="836" y1="1589.6875" y2="1589.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="261" y="1584.6216">accessToken</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="189" x2="906" y1="1598.6875" y2="1598.6875"/><path d="M787,1604.6875 L787,1629.6875 L892,1629.6875 L892,1614.6875 L882,1604.6875 L787,1604.6875 " fill="#ECECEC" filter="url(#f9npktkeyjjaz)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M882,1604.6875 L882,1614.6875 L892,1614.6875 L882,1604.6875 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="793" y="1621.7544">Log(AuthFail)</text><polygon fill="#383838" points="255,1655.9531,245,1659.9531,255,1663.9531,251,1659.9531" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="249" x2="841" y1="1659.9531" y2="1659.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="261" y="1654.8872">REJECT</text><!--MD5=[fb999f06a1b4db3711409c04dd486b58]
@startuml dSignInSequence
skinparam monochrome true

title dSignIn - 3 step process
opt Precondition
note over Consumer
    username = Consumer username
    password [private] = Consumer's password
end note
note over mORKx
    userId = hash(username)
    AuthPRISMi = share(AuthPRISM, orkId) [private]
    CMKAuthi = hmac(pkORKi, AuthProof) [private]
    CMKi = share(skCMK, orkId) [private]
end note
note over vORKx
    VUID = hash(pkVen * skCMK)
    CVKAuthi = hmac(pkORKi, pkVen * skCMK) [private]
    CVKi = share(skCVK, orkId) [private]
end note
note over Vendor
    VUID = hash(pkVen * skCMK)
    pkCVK
end note
end
Consumer->Vendor: GetChallenge()
activate Vendor

Vendor- ->Consumer: pkVen, challenge
note over Consumer
    r1 = random [private]
    userId = hash(username)
    gPass = point(hash(password)) [private]
end note
Consumer->Consumer: Resolve mORKs by userId
Consumer->mORKx: Convert( userId , gPass * r1 )
activate mORKx

note over mORKx
    (gPass * r1) ∈ G
    timestamp = now()
    certtime = hmac(timestamp, skORK)
end note 
mORKx- ->Consumer: gPass * r1 * AuthPRISMi, timestamp, certtime
deactivate mORKx

note over Consumer
    r2 = random [private]
    gPass * AuthPRISM = ∑(gPass * r1 * AuthPRISMi) * (r1 ^ -1)
    authProof = hash(gPass * AuthPRISM)
    authVRFYi = hmac(pkORKi, authProof)
    VERIFYi = hmac(userId | pkVen * r2 | timestamp | certtime, authVRFYi)
end note
Consumer->mORKx: Authenticate( userId , pkVen * r2 , timestamp , certtime , VERIFYi )
activate mORKx

note over mORKx
    (pkVen * r2) ∈ G ?
    verifyCheck = hmac(userId | pkVen * r2 | timestamp | certtime, CMKAuthi)
end note 
alt verifyCheck == VERIFYi ?
    note over mORKx: Log(AuthOK)
    mORKx- ->Consumer: aesEnc(pkVen * r2 * CMKi, CMKAuthi)
else
    note over mORKx: Log(AuthFail)
    mORKx- ->Consumer: Some consistent garbage
    deactivate mORKx
    
end
note over Consumer
    aesDec(pkVen * r2 * CMKi, authVRFYi)
    cvkAuth = pkVen * skCMK = ∑(pkVen * r2 * CMKi) * (r2 ^ -1)
    VUID = hash(cvkAuth)
    getVRFYi = hmac(pkORKi, cvkAuth)
    VERIFYi = hmac(VUID | timestamp , getVRFYi)
end note
Consumer->Consumer: Resolve vORKs by VUID
Consumer->vORKx: GetKey( VUID , timestamp , VERIFYi )
activate vORKx

note over vORKx
    if timestamp is not current, reply with a challenge
    verifyCheck = hmac(VUID | timestamp , CVKAuthi)
end note 
alt verifyCheck == VERIFYi ?
    note over vORKx: Log(AuthOK)
    vORKx- ->Consumer: aesEnc(CVKi, CVKAuthi)
else
    note over vORKx: Log(AuthFail)
    vORKx- ->Consumer: Some consistent garbage
    deactivate vORKx
    
end
note over Consumer
    CVK = ∑(aesDec(CMKi, getVRFYi))
    challengeRes = ECSign(challenge, skCVK)
end note
Consumer->Vendor: SignIn( VUID , challengeRes )
alt verifySig(challengeRes, pkCVK) ?
    note over Vendor: Log(AuthOK)
    Vendor- ->Consumer: accessToken
else
    note over Vendor: Log(AuthFail)
    Vendor- ->Consumer: REJECT
    deactivate Vendor
    
end

@enduml

PlantUML version 1.2020.10(Sun May 17 19:35:57 AEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.8+10-post-Ubuntu-0ubuntu118.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>