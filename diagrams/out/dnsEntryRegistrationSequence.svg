<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1046px" preserveAspectRatio="none" style="width:1256px;height:1046px;" version="1.1" viewBox="0 0 1256 1046" width="1256px" zoomAndPan="magnify"><defs><filter height="300%" id="fveuo8xgfzjya" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="206" x="523" y="28.708">DNS Entry Registration</text><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="295.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="355" y="217.7813"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="295.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="416" y="246.9141"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="295.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="540" y="276.0469"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="275.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="540" y="668.9063"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="220.0625" style="stroke: #383838; stroke-width: 1.0;" width="10" x="903" y="703.0391"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="119.5313" style="stroke: #000000; stroke-width: 2.0;" width="732.5" x="509.5" y="796.5703"/><rect fill="#FFFFFF" height="31.1328" style="stroke: none; stroke-width: 1.0;" width="732.5" x="509.5" y="884.9688"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="187" x2="187" y1="123.25" y2="962.2344"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="359.5" x2="359.5" y1="123.25" y2="962.2344"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="420.5" x2="420.5" y1="123.25" y2="962.2344"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="544.5" x2="544.5" y1="123.25" y2="962.2344"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="908" x2="908" y1="123.25" y2="962.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="148" y="119.9482">Consumer</text><ellipse cx="187" cy="49.9531" fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" rx="8" ry="8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M187,57.9531 L187,84.9531 M174,65.9531 L200,65.9531 M187,84.9531 L174,99.9531 M187,84.9531 L200,99.9531 " fill="none" filter="url(#fveuo8xgfzjya)" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="148" y="974.2295">Consumer</text><ellipse cx="187" cy="987.5313" fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" rx="8" ry="8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M187,995.5313 L187,1022.5313 M174,1003.5313 L200,1003.5313 M187,1022.5313 L174,1037.5313 M187,1022.5313 L200,1037.5313 " fill="none" filter="url(#fveuo8xgfzjya)" style="stroke: #383838; stroke-width: 2.0;"/><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="334.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="341.5" y="107.9482">Ork1</text><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="334.5" y="961.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="341.5" y="981.2295">Ork1</text><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="395.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="402.5" y="107.9482">Ork2</text><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="395.5" y="961.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="402.5" y="981.2295">Ork2</text><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="519.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="526.5" y="107.9482">Ork3</text><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="519.5" y="961.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="526.5" y="981.2295">Ork3</text><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="78" x="867" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="874" y="107.9482">Simulator</text><rect fill="#F8F8F8" filter="url(#fveuo8xgfzjya)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="78" x="867" y="961.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="874" y="981.2295">Simulator</text><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="295.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="355" y="217.7813"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="295.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="416" y="246.9141"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="295.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="540" y="276.0469"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="275.3281" style="stroke: #383838; stroke-width: 1.0;" width="10" x="540" y="668.9063"/><rect fill="#FFFFFF" filter="url(#fveuo8xgfzjya)" height="220.0625" style="stroke: #383838; stroke-width: 1.0;" width="10" x="903" y="703.0391"/><polygon fill="#ECECEC" filter="url(#fveuo8xgfzjya)" points="83,138.25,291,138.25,301,164.25,291,191.25,83,191.25,73,164.25,83,138.25" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="85" y="154.3169">uid = hash(username)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="85" y="169.4497">cmk = random</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="85" y="184.5825">cmki = secretshare(cmk, orkIdi)</text><polygon fill="#383838" points="343,213.7813,353,217.7813,343,221.7813,347,217.7813" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="187" x2="349" y1="217.7813" y2="217.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="194" y="212.7153">registerCMK(uid, cmk1)</text><polygon fill="#383838" points="404,242.9141,414,246.9141,404,250.9141,408,246.9141" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="187" x2="410" y1="246.9141" y2="246.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="194" y="241.8481">registerCMK(uid, cmk2)</text><polygon fill="#383838" points="528,272.0469,538,276.0469,528,280.0469,532,276.0469" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="187" x2="534" y1="276.0469" y2="276.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="194" y="270.981">registerCMK(uid, cmk3)</text><polygon fill="#383838" points="896,301.1797,906,305.1797,896,309.1797,900,305.1797" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="365" x2="902" y1="305.1797" y2="305.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="372" y="300.1138">addCMK(orkId1, uid, cmk1)</text><polygon fill="#383838" points="896,330.3125,906,334.3125,896,338.3125,900,334.3125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="426" x2="902" y1="334.3125" y2="334.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="433" y="329.2466">addCMK(orkId2, uid, cmk2)</text><polygon fill="#383838" points="896,359.4453,906,363.4453,896,367.4453,900,363.4453" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="550" x2="902" y1="363.4453" y2="363.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="557" y="358.3794">addCMK(orkId3, uid, cmk3)</text><polygon fill="#383838" points="376,388.5781,366,392.5781,376,396.5781,372,392.5781" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="370" x2="907" y1="392.5781" y2="392.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="382" y="387.5122">OK</text><polygon fill="#383838" points="437,417.7109,427,421.7109,437,425.7109,433,421.7109" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="431" x2="907" y1="421.7109" y2="421.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="443" y="416.645">OK</text><polygon fill="#383838" points="561,446.8438,551,450.8438,561,454.8438,557,450.8438" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="555" x2="907" y1="450.8438" y2="450.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="567" y="445.7778">OK</text><polygon fill="#ECECEC" filter="url(#fveuo8xgfzjya)" points="343,463.8438,561,463.8438,571,474.8438,561,486.8438,343,486.8438,333,474.8438,343,463.8438" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="345" y="479.9106">signOrki = sign(uid|orkIdi, orkPrvi)</text><polygon fill="#383838" points="198,509.1094,188,513.1094,198,517.1094,194,513.1094" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="192" x2="359" y1="513.1094" y2="513.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="204" y="508.0435">signOrk1</text><polygon fill="#383838" points="198,538.2422,188,542.2422,198,546.2422,194,542.2422" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="192" x2="420" y1="542.2422" y2="542.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="204" y="537.1763">signOrk2</text><polygon fill="#383838" points="198,567.375,188,571.375,198,575.375,194,571.375" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="192" x2="544" y1="571.375" y2="571.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="204" y="566.3091">signOrk3</text><polygon fill="#ECECEC" filter="url(#fveuo8xgfzjya)" points="15,584.375,359,584.375,369,610.375,359,637.375,15,637.375,5,610.375,15,584.375" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="17" y="600.4419">signUid = sign(uid|cmkPub|orkId1|orkId2|orkId3, cmk)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="17" y="615.5747">orkIds = [orkId1, orkId2, orkId3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="17" y="630.7075">signOrks = [signOrk1, signOrk2, signOrk3]</text><polygon fill="#383838" points="528,664.9063,538,668.9063,528,672.9063,532,668.9063" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="187" x2="534" y1="668.9063" y2="668.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="334" x="194" y="663.8403">addDnsEntry(uid, cmkPub, orkIds, signOrks, signUid)</text><path d="M555,647.7734 L555,672.7734 L720,672.7734 L720,657.7734 L710,647.7734 L555,647.7734 " fill="#ECECEC" filter="url(#fveuo8xgfzjya)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M710,647.7734 L710,657.7734 L720,657.7734 L710,647.7734 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="561" y="664.8403">randomly selected Ork</text><polygon fill="#383838" points="891,699.0391,901,703.0391,891,707.0391,895,703.0391" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="550" x2="897" y1="703.0391" y2="703.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="334" x="557" y="697.9731">addDnsEntry(uid, cmkPub, orkIds, signOrks, signUid)</text><polygon fill="#ECECEC" filter="url(#fveuo8xgfzjya)" points="704,716.0391,1112,716.0391,1122,750.0391,1112,784.0391,704,784.0391,694,750.0391,704,716.0391" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="706" y="732.106">existDnsEntry = getDns(uid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="706" y="747.2388">orkPubs = getPublics([orkId1, orkId2, orkId3])</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="404" x="706" y="762.3716">isUidVerified = verify(uid|cmkPub|orkId1|orkId2|orkId3, cmkPub)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="706" y="777.5044">isOrkiVerified = verify(uid|orkIdi, orkPubi)</text><path d="M509.5,796.5703 L573.5,796.5703 L573.5,803.5703 L563.5,813.5703 L509.5,813.5703 L509.5,796.5703 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="119.5313" style="stroke: #000000; stroke-width: 2.0;" width="732.5" x="509.5" y="796.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="524.5" y="809.6372">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="328" x="588.5" y="808.7808">[isUidVerified &amp;&amp; isOrkiVerified &amp;&amp; !existDnsEntry]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="913" x2="955" y1="834.8359" y2="834.8359"/><line style="stroke: #383838; stroke-width: 1.0;" x1="955" x2="955" y1="834.8359" y2="847.8359"/><line style="stroke: #383838; stroke-width: 1.0;" x1="914" x2="955" y1="847.8359" y2="847.8359"/><polygon fill="#383838" points="924,843.8359,914,847.8359,924,851.8359,920,847.8359" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="310" x="920" y="829.77">storeDns(uid, cmkPub, orkIds, signOrks, signUid)</text><polygon fill="#383838" points="561,872.9688,551,876.9688,561,880.9688,557,876.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="555" x2="902" y1="876.9688" y2="876.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="567" y="871.9028">ok</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="509.5" x2="1242" y1="885.9688" y2="885.9688"/><polygon fill="#383838" points="561,904.1016,551,908.1016,561,912.1016,557,908.1016" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="555" x2="902" y1="908.1016" y2="908.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="567" y="903.0356">invalid signature</text><polygon fill="#383838" points="198,940.2344,188,944.2344,198,948.2344,194,944.2344" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="192" x2="544" y1="944.2344" y2="944.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="204" y="939.1685">response</text><!--MD5=[6ee1382dec76738ae105452e5c2572ff]
@startuml dnsEntryRegistrationSequence
skinparam monochrome true
actor Consumer

title DNS Entry Registration
hnote over Consumer
uid = hash(username)
cmk = random
cmki = secretshare(cmk, orkIdi)
end note

Consumer -> Ork1: registerCMK(uid, cmk1)
activate Ork1
Consumer -> Ork2: registerCMK(uid, cmk2)
activate Ork2
Consumer -> Ork3: registerCMK(uid, cmk3)
activate Ork3

Ork1 -> Simulator: addCMK(orkId1, uid, cmk1)
Ork2 -> Simulator: addCMK(orkId2, uid, cmk2)
Ork3 -> Simulator: addCMK(orkId3, uid, cmk3)

Simulator - -> Ork1: OK
Simulator - -> Ork2: OK
Simulator - -> Ork3: OK

hnote over Ork1, Ork3: signOrki = sign(uid|orkIdi, orkPrvi)

Ork1 - -> Consumer: signOrk1
deactivate Ork1
Ork2 - -> Consumer: signOrk2
deactivate Ork2
Ork3 - -> Consumer: signOrk3
deactivate Ork3

hnote over Consumer
    signUid = sign(uid|cmkPub|orkId1|orkId2|orkId3, cmk)
    orkIds = [orkId1, orkId2, orkId3]
    signOrks = [signOrk1, signOrk2, signOrk3]
end note

Consumer -> Ork3: addDnsEntry(uid, cmkPub, orkIds, signOrks, signUid)
note right: randomly selected Ork
activate Ork3

Ork3 -> Simulator: addDnsEntry(uid, cmkPub, orkIds, signOrks, signUid)
activate Simulator

hnote over Simulator
existDnsEntry = getDns(uid)
orkPubs = getPublics([orkId1, orkId2, orkId3])
isUidVerified = verify(uid|cmkPub|orkId1|orkId2|orkId3, cmkPub)
isOrkiVerified = verify(uid|orkIdi, orkPubi)
end note

alt isUidVerified && isOrkiVerified && !existDnsEntry
    Simulator -> Simulator: storeDns(uid, cmkPub, orkIds, signOrks, signUid)
    Simulator - -> Ork3: ok
else
    Simulator - -> Ork3: invalid signature
end
deactivate Simulator

Ork3 - -> Consumer: response
deactivate Ork3
@enduml

PlantUML version 1.2020.18(Thu Oct 01 05:40:44 AEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>