<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2161px" preserveAspectRatio="none" style="width:1250px;height:2161px;" version="1.1" viewBox="0 0 1250 2161" width="1250px" zoomAndPan="magnify"><defs><filter height="300%" id="f18n94j2nub9fw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="97" x="578.75" y="28.708">dSignUpV2</text><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="490" y="357.1797"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="153.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="490" y="887.1641"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="173.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="490" y="1645.75"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="264.1953" style="stroke: #383838; stroke-width: 1.0;" width="10" x="624" y="1077.0938"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="58.2656" style="stroke: #383838; stroke-width: 1.0;" width="10" x="624" y="1522.2188"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="174.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="624" y="1855.6797"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="141.6641" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1106.2266"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1439.8203"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="58.2656" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1551.3516"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1699.0156"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="145.6641" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1913.9453"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="116.5313" style="stroke: #383838; stroke-width: 1.0;" width="10" x="1204" y="1884.8125"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="1209" y="1943.0781"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="188.7969" style="stroke: #000000; stroke-width: 2.0;" width="990" x="10" y="140.25"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="146.7969" style="stroke: #000000; stroke-width: 2.0;" width="530" x="122" y="902.1641"/><rect fill="#FFFFFF" height="100.5313" style="stroke: none; stroke-width: 1.0;" width="530" x="122" y="948.4297"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="134.6641" style="stroke: #000000; stroke-width: 2.0;" width="984" x="122" y="1121.2266"/><rect fill="#FFFFFF" height="88.3984" style="stroke: none; stroke-width: 1.0;" width="984" x="122" y="1167.4922"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="815" x="122" y="1483.9531"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="486" x="451" y="1660.75"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="77.3984" style="stroke: #000000; stroke-width: 2.0;" width="417" x="122" y="1750.1484"/><rect fill="#FFFFFF" height="31.1328" style="stroke: none; stroke-width: 1.0;" width="417" x="122" y="1796.4141"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="171" x2="171" y1="123.25" y2="2077.6094"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="495" x2="495" y1="123.25" y2="2077.6094"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="629" x2="629" y1="123.25" y2="2077.6094"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="896" x2="896" y1="123.25" y2="2077.6094"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1208.5" x2="1208.5" y1="123.25" y2="2077.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="132" y="119.9482">Consumer</text><ellipse cx="171" cy="49.9531" fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" rx="8" ry="8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M171,57.9531 L171,84.9531 M158,65.9531 L184,65.9531 M171,84.9531 L158,99.9531 M171,84.9531 L184,99.9531 " fill="none" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="132" y="2089.6045">Consumer</text><ellipse cx="171" cy="2102.9063" fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" rx="8" ry="8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M171,2110.9063 L171,2137.9063 M158,2118.9063 L184,2118.9063 M171,2137.9063 L158,2152.9063 M171,2137.9063 L184,2152.9063 " fill="none" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 2.0;"/><rect fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="461" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="468" y="107.9482">Vendor</text><rect fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="461" y="2076.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="468" y="2096.6045">Vendor</text><rect fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="595" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="602" y="107.9482">mORKx</text><rect fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="64" x="595" y="2076.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="602" y="2096.6045">mORKx</text><rect fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="58" x="865" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="872" y="107.9482">vORKx</text><rect fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="58" x="865" y="2076.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="872" y="2096.6045">vORKx</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="1168.5" y="119.9482">Blockchain</text><path d="M1191,70.9531 C1191,60.9531 1209,60.9531 1209,60.9531 C1209,60.9531 1227,60.9531 1227,70.9531 L1227,96.9531 C1227,106.9531 1209,106.9531 1209,106.9531 C1209,106.9531 1191,106.9531 1191,96.9531 L1191,70.9531 " fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1191,70.9531 C1191,80.9531 1209,80.9531 1209,80.9531 C1209,80.9531 1227,80.9531 1227,70.9531 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="1168.5" y="2089.6045">Blockchain</text><path d="M1191,2102.9063 C1191,2092.9063 1209,2092.9063 1209,2092.9063 C1209,2092.9063 1227,2092.9063 1227,2102.9063 L1227,2128.9063 C1227,2138.9063 1209,2138.9063 1209,2138.9063 C1209,2138.9063 1191,2138.9063 1191,2128.9063 L1191,2102.9063 " fill="#F8F8F8" filter="url(#f18n94j2nub9fw)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1191,2102.9063 C1191,2112.9063 1209,2112.9063 1209,2112.9063 C1209,2112.9063 1227,2112.9063 1227,2102.9063 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="490" y="357.1797"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="153.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="490" y="887.1641"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="173.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="490" y="1645.75"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="264.1953" style="stroke: #383838; stroke-width: 1.0;" width="10" x="624" y="1077.0938"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="58.2656" style="stroke: #383838; stroke-width: 1.0;" width="10" x="624" y="1522.2188"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="174.7969" style="stroke: #383838; stroke-width: 1.0;" width="10" x="624" y="1855.6797"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="141.6641" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1106.2266"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1439.8203"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="58.2656" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1551.3516"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1699.0156"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="145.6641" style="stroke: #383838; stroke-width: 1.0;" width="10" x="891" y="1913.9453"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="116.5313" style="stroke: #383838; stroke-width: 1.0;" width="10" x="1204" y="1884.8125"/><rect fill="#FFFFFF" filter="url(#f18n94j2nub9fw)" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="1209" y="1943.0781"/><path d="M10,140.25 L148,140.25 L148,147.25 L138,157.25 L10,157.25 L10,140.25 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="188.7969" style="stroke: #000000; stroke-width: 2.0;" width="990" x="10" y="140.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="25" y="153.3169">Precondition</text><path d="M20,162.3828 L20,202.3828 L318,202.3828 L318,172.3828 L308,162.3828 L20,162.3828 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M308,162.3828 L308,172.3828 L318,172.3828 L308,162.3828 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="26" y="179.4497">username = Consumer username</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="26" y="194.5825">password [private] = Consumer's password</text><path d="M421,216.6484 L421,241.6484 L564,241.6484 L564,226.6484 L554,216.6484 L421,216.6484 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M554,216.6484 L554,226.6484 L564,226.6484 L554,216.6484 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="427" y="233.7153">vId, skVen, pubVen</text><path d="M526,255.7813 L526,280.7813 L728,280.7813 L728,265.7813 L718,255.7813 L526,255.7813 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M718,255.7813 L718,265.7813 L728,265.7813 L718,255.7813 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="532" y="272.8481">mIdOrki, mSkOrki, mPubOrki</text><path d="M802,294.9141 L802,319.9141 L986,319.9141 L986,304.9141 L976,294.9141 L802,294.9141 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M976,294.9141 L976,304.9141 L986,304.9141 L976,294.9141 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="808" y="311.981">vIdOrki, vSkOrki, vPubOrki</text><polygon fill="#383838" points="478,353.1797,488,357.1797,478,361.1797,482,357.1797" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="484" y1="357.1797" y2="357.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="178" y="352.1138">GetConfig()</text><polygon fill="#383838" points="182,382.3125,172,386.3125,182,390.3125,178,386.3125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="494" y1="386.3125" y2="386.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="188" y="381.2466">pubVen, List(vOrk)</text><path d="M27,399.3125 L27,666.3125 L311,666.3125 L311,409.3125 L301,399.3125 L27,399.3125 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M301,399.3125 L301,409.3125 L311,409.3125 L301,399.3125 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="33" y="416.3794">userId = hash(username)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="37" y="431.5122"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="33" y="446.645">CMK = random</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="33" y="461.7778">PubCMK = g * CMK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="33" y="476.9106">CMKAuth = hash(CMK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="37" y="492.0435"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="33" y="507.1763">gPass = point(hash(password))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="33" y="522.3091">PRISM = random</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="33" y="537.4419">PRISMAuth = hash(gPass * PRISM)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="37" y="552.5747"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="33" y="567.7075">CMKi = share(CMK, mIdOrki)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="33" y="582.8403">PRISMi = share(PRISM, mIdOrki)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="37" y="597.9731"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="33" y="613.106">CMKAuthi = hmac(mIdOrki, CMKAuth)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="263" x="33" y="628.2388">PRISMAuthi = hmac(mIdOrki, PRISMAuth)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="37" y="643.3716"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="33" y="658.5044">mOrki = List(mOrk)</text><path d="M43,680.5703 L43,856.5703 L295,856.5703 L295,690.5703 L285,680.5703 L43,680.5703 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M285,680.5703 L285,690.5703 L295,690.5703 L285,680.5703 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="49" y="697.6372">CVK = random</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="49" y="712.77">PubCVK = g * CVK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="49" y="727.9028">CVKi = share(CVK, vIdOrki)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="53" y="743.0356"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="49" y="758.1685">VUID = hmac(pubVen, CMKAuth)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="49" y="773.3013">CVKAuth = hash(pubVen * CMK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="53" y="788.4341"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="49" y="803.5669">CVKAuthi = hmac(vIdOrki, CVKAuth)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="49" y="818.6997">VUIDAuth = hmac(vid, CVK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="53" y="833.8325"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="49" y="848.9653">vOrki = List(vOrk)</text><polygon fill="#383838" points="478,883.1641,488,887.1641,478,891.1641,482,887.1641" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="484" y1="887.1641" y2="887.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="178" y="882.0981">GetVoucher(VUID, VUIDAuth, PubCVK, vOrki)</text><path d="M122,902.1641 L186,902.1641 L186,909.1641 L176,919.1641 L122,919.1641 L122,902.1641 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="146.7969" style="stroke: #000000; stroke-width: 2.0;" width="530" x="122" y="902.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="137" y="915.231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="201" y="914.3745">[vOrki ∉ List(vOrk)]</text><polygon fill="#383838" points="182,936.4297,172,940.4297,182,944.4297,178,940.4297" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="489" y1="940.4297" y2="940.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="188" y="935.3638">Error("Selected ORKs are not in the given list")</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122" x2="652" y1="949.4297" y2="949.4297"/><path d="M348,955.4297 L348,1010.4297 L638,1010.4297 L638,965.4297 L628,955.4297 L348,955.4297 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M628,955.4297 L628,965.4297 L638,965.4297 L628,955.4297 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="354" y="972.4966">Voucher = GenVoucherKey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="354" y="987.6294">pubVoucher = g * Voucher</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="354" y="1002.7622">signi = Sign(VUID|PubCVK|vOrki, Voucher)</text><polygon fill="#383838" points="182,1036.9609,172,1040.9609,182,1044.9609,178,1040.9609" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="494" y1="1040.9609" y2="1040.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="188" y="1035.895">signi, pubVoucher</text><polygon fill="#383838" points="612,1073.0938,622,1077.0938,612,1081.0938,616,1077.0938" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="618" y1="1077.0938" y2="1077.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="434" x="178" y="1072.0278">Signup(userId, PubCMK, CMKi, PRISMi, CMKAuthi, PRISMAuthi, email)</text><polygon fill="#383838" points="879,1102.2266,889,1106.2266,879,1110.2266,883,1106.2266" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="885" y1="1106.2266" y2="1106.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="410" x="178" y="1101.1606">Signup(VUID, PubCVK, CVKi, CVKAuthi, vOrki, signi, pubVoucher)</text><path d="M122,1121.2266 L186,1121.2266 L186,1128.2266 L176,1138.2266 L122,1138.2266 L122,1121.2266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="134.6641" style="stroke: #000000; stroke-width: 2.0;" width="984" x="122" y="1121.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="137" y="1134.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="201" y="1133.437">[!(Verify(VUID|PubCVK|vOrki, signi, pubVoucher))]</text><polygon fill="#383838" points="182,1155.4922,172,1159.4922,182,1163.4922,178,1159.4922" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="890" y1="1159.4922" y2="1159.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="188" y="1154.4263">Error("Invalid voucher")</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122" x2="1106" y1="1168.4922" y2="1168.4922"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="901" x2="943" y1="1205.7578" y2="1205.7578"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="943" x2="943" y1="1205.7578" y2="1218.7578"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="902" x2="943" y1="1218.7578" y2="1218.7578"/><polygon fill="#383838" points="912,1214.7578,902,1218.7578,912,1222.7578,908,1218.7578" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="908" y="1185.5591">StoreMemory(VUID, PubCVK,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="912" y="1200.6919">CVKi, CVKAuthi, vOrki)</text><polygon fill="#383838" points="182,1243.8906,172,1247.8906,182,1251.8906,178,1247.8906" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="895" y1="1247.8906" y2="1247.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="1242.8247">OK</text><line style="stroke: #383838; stroke-width: 1.0;" x1="634" x2="676" y1="1299.1563" y2="1299.1563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="676" x2="676" y1="1299.1563" y2="1312.1563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="635" x2="676" y1="1312.1563" y2="1312.1563"/><polygon fill="#383838" points="645,1308.1563,635,1312.1563,645,1316.1563,641,1312.1563" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="641" y="1278.9575">StoreMemory(userId, PubCMK, CMKi,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="645" y="1294.0903">PRISMi, CMKAuthi, PRISMAuthi, email)</text><polygon fill="#383838" points="182,1337.2891,172,1341.2891,182,1345.2891,178,1341.2891" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="628" y1="1341.2891" y2="1341.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="1336.2231">OK</text><path d="M19,1354.2891 L19,1409.2891 L319,1409.2891 L319,1364.2891 L309,1354.2891 L19,1354.2891 " fill="#ECECEC" filter="url(#f18n94j2nub9fw)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M309,1354.2891 L309,1364.2891 L319,1364.2891 L309,1354.2891 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="25" y="1371.356">VUIDTag = hash("VUID")</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="271" x="25" y="1386.4888">VUIDRule = allow(VUID, VUIDTag, PubVen)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="25" y="1401.6216">VUIDCipher = encrypt(VUID, VUIDTag, CVK)</text><polygon fill="#383838" points="879,1435.8203,889,1439.8203,879,1443.8203,883,1439.8203" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="885" y1="1439.8203" y2="1439.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="178" y="1434.7544">AddRule(VUIDRule)</text><polygon fill="#383838" points="182,1464.9531,172,1468.9531,182,1472.9531,178,1468.9531" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="895" y1="1468.9531" y2="1468.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="1463.8872">OK</text><path d="M122,1483.9531 L256,1483.9531 L256,1490.9531 L246,1500.9531 L122,1500.9531 L122,1483.9531 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="815" x="122" y="1483.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="137" y="1497.02">dSignInFlow</text><polygon fill="#383838" points="612,1518.2188,622,1522.2188,612,1526.2188,616,1522.2188" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="618" y1="1522.2188" y2="1522.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="178" y="1517.1528">SignIn()</text><polygon fill="#383838" points="879,1547.3516,889,1551.3516,879,1555.3516,883,1551.3516" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="885" y1="1551.3516" y2="1551.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="178" y="1546.2856">SignIn()</text><polygon fill="#383838" points="182,1576.4844,172,1580.4844,182,1584.4844,178,1580.4844" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="628" y1="1580.4844" y2="1580.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="1575.4185">OK</text><polygon fill="#383838" points="182,1605.6172,172,1609.6172,182,1613.6172,178,1609.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="895" y1="1609.6172" y2="1609.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="1604.5513">OK</text><polygon fill="#383838" points="478,1641.75,488,1645.75,478,1649.75,482,1645.75" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="484" y1="1645.75" y2="1645.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="178" y="1640.6841">SignUp(VUID, VUIDAuth, vOrki, VUIDCipher)</text><path d="M451,1660.75 L616,1660.75 L616,1667.75 L606,1677.75 L451,1677.75 L451,1660.75 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="486" x="451" y="1660.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="466" y="1673.8169">tDecryptionFlow</text><polygon fill="#383838" points="879,1695.0156,889,1699.0156,879,1703.0156,883,1699.0156" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="500" x2="885" y1="1699.0156" y2="1699.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="507" y="1693.9497">tDecrypt(VUIDCipher)</text><polygon fill="#383838" points="511,1724.1484,501,1728.1484,511,1732.1484,507,1728.1484" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="505" x2="895" y1="1728.1484" y2="1728.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="517" y="1723.0825">VUIDPlain</text><path d="M122,1750.1484 L186,1750.1484 L186,1757.1484 L176,1767.1484 L122,1767.1484 L122,1750.1484 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="77.3984" style="stroke: #000000; stroke-width: 2.0;" width="417" x="122" y="1750.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="137" y="1763.2153">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="201" y="1762.3589">[VUIDPlain != VUID]</text><polygon fill="#383838" points="182,1784.4141,172,1788.4141,182,1792.4141,178,1788.4141" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="489" y1="1788.4141" y2="1788.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="295" x="188" y="1783.3481">Error("Threshold description must be allowed")</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122" x2="539" y1="1797.4141" y2="1797.4141"/><polygon fill="#383838" points="182,1815.5469,172,1819.5469,182,1823.5469,178,1819.5469" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="494" y1="1819.5469" y2="1819.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="1814.481">OK</text><polygon fill="#383838" points="612,1851.6797,622,1855.6797,612,1859.6797,616,1855.6797" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="618" y1="1855.6797" y2="1855.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="178" y="1850.6138">Commit(userId)</text><polygon fill="#383838" points="1192,1880.8125,1202,1884.8125,1192,1888.8125,1196,1884.8125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="634" x2="1198" y1="1884.8125" y2="1884.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="425" x="641" y="1879.7466">Store(userId, PubCMK, CMKi, PRISMi, CMKAuthi, PRISMAuthi, email)</text><polygon fill="#383838" points="879,1909.9453,889,1913.9453,879,1917.9453,883,1913.9453" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="171" x2="885" y1="1913.9453" y2="1913.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="178" y="1908.8794">Commit(VUID)</text><polygon fill="#383838" points="1197,1939.0781,1207,1943.0781,1197,1947.0781,1201,1943.0781" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="901" x2="1203" y1="1943.0781" y2="1943.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="908" y="1938.0122">Store(VUID, PubCVK, CVKi, CVKAuthi, vOrki)</text><polygon fill="#383838" points="912,1968.2109,902,1972.2109,912,1976.2109,908,1972.2109" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="906" x2="1203" y1="1972.2109" y2="1972.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="918" y="1967.145">OK</text><polygon fill="#383838" points="645,1997.3438,635,2001.3438,645,2005.3438,641,2001.3438" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="639" x2="1208" y1="2001.3438" y2="2001.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="651" y="1996.2778">OK</text><polygon fill="#383838" points="182,2026.4766,172,2030.4766,182,2034.4766,178,2030.4766" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="628" y1="2030.4766" y2="2030.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="2025.4106">OK</text><polygon fill="#383838" points="182,2055.6094,172,2059.6094,182,2063.6094,178,2059.6094" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176" x2="895" y1="2059.6094" y2="2059.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="188" y="2054.5435">OK</text><!--MD5=[da5a680c6495fcf66fc45989e7e80f91]
@startuml dSignUpV2Sequence
skinparam monochrome true

title dSignUpV2

actor Consumer 
participant Vendor
participant mORKx
participant vORKx
database Blockchain as Block

group Precondition
note over Consumer
    username = Consumer username
    password [private] = Consumer's password
end note
note over Vendor
    vId, skVen, pubVen
end note
note over mORKx
    mIdOrki, mSkOrki, mPubOrki
end note
note over vORKx
    vIdOrki, vSkOrki, vPubOrki
end note
end

Consumer->Vendor: GetConfig()
activate Vendor

Vendor- ->Consumer: pubVen, List(vOrk)
deactivate Vendor

note over Consumer
    userId = hash(username)
    
    CMK = random
    PubCMK = g * CMK
    CMKAuth = hash(CMK)

    gPass = point(hash(password))
    PRISM = random
    PRISMAuth = hash(gPass * PRISM)

    CMKi = share(CMK, mIdOrki)
    PRISMi = share(PRISM, mIdOrki)

    CMKAuthi = hmac(mIdOrki, CMKAuth)
    PRISMAuthi = hmac(mIdOrki, PRISMAuth)

    mOrki = List(mOrk)
end note
    
note over Consumer
    CVK = random
    PubCVK = g * CVK
    CVKi = share(CVK, vIdOrki)

    VUID = hmac(pubVen, CMKAuth)
    CVKAuth = hash(pubVen * CMK)

    CVKAuthi = hmac(vIdOrki, CVKAuth)
    VUIDAuth = hmac(vid, CVK)

    vOrki = List(vOrk)
end note


Consumer -> Vendor: GetVoucher(VUID, VUIDAuth, PubCVK, vOrki)
activate Vendor

alt vOrki ∉ List(vOrk)
    Vendor - -> Consumer: Error("Selected ORKs are not in the given list")
else
    note over Vendor
        Voucher = GenVoucherKey()
        pubVoucher = g * Voucher
        signi = Sign(VUID|PubCVK|vOrki, Voucher)
    end note

    Vendor - -> Consumer: signi, pubVoucher
    deactivate Vendor
end

Consumer -> mORKx: Signup(userId, PubCMK, CMKi, PRISMi, CMKAuthi, PRISMAuthi, email)
activate mORKx

Consumer -> vORKx: Signup(VUID, PubCVK, CVKi, CVKAuthi, vOrki, signi, pubVoucher)
activate vORKx

alt !(Verify(VUID|PubCVK|vOrki, signi, pubVoucher))
    vORKx - -> Consumer: Error("Invalid voucher")
else
    vORKx - -> vORKx: StoreMemory(VUID, PubCVK,\n CVKi, CVKAuthi, vOrki)
    
    vORKx - -> Consumer: OK
    deactivate vORKx
end

mORKx -> mORKx: StoreMemory(userId, PubCMK, CMKi,\n PRISMi, CMKAuthi, PRISMAuthi, email)

mORKx - -> Consumer: OK
deactivate mORKx

note over Consumer
    VUIDTag = hash("VUID")
    VUIDRule = allow(VUID, VUIDTag, PubVen)
    VUIDCipher = encrypt(VUID, VUIDTag, CVK)
end note

Consumer -> vORKx: AddRule(VUIDRule)
activate vORKx
vORKx - -> Consumer: OK
deactivate vORKx

group dSignInFlow
    Consumer -> mORKx: SignIn()
    activate mORKx
    Consumer -> vORKx: SignIn()
    activate vORKx

    mORKx - -> Consumer: OK
    deactivate mORKx
    vORKx - -> Consumer: OK
    deactivate vORKx
end

Consumer -> Vendor: SignUp(VUID, VUIDAuth, vOrki, VUIDCipher)
activate Vendor

group tDecryptionFlow
    Vendor -> vORKx: tDecrypt(VUIDCipher)
    activate vORKx
    vORKx - -> Vendor: VUIDPlain
    deactivate vORKx
end

alt VUIDPlain != VUID
    Vendor - -> Consumer: Error("Threshold description must be allowed")
else
    Vendor - -> Consumer: OK
    deactivate Vendor
end


Consumer -> mORKx: Commit(userId)
activate mORKx
mORKx -> Block: Store(userId, PubCMK, CMKi, PRISMi, CMKAuthi, PRISMAuthi, email)
activate Block

Consumer -> vORKx: Commit(VUID)
activate vORKx


vORKx -> Block: Store(VUID, PubCVK, CVKi, CVKAuthi, vOrki)
activate Block

Block - -> vORKx: OK
deactivate Block

Block - -> mORKx: OK
deactivate Block

mORKx - -> Consumer: OK
deactivate mORKx

vORKx - -> Consumer: OK
deactivate vORKx

@enduml

PlantUML version 1.2020.18(Thu Oct 01 05:40:44 AEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>